document.getElementById("fileInput").addEventListener("change",function(t){let e=t.target.files;e.length&&(clearResults(),globalArticles=[],Array.from(e).forEach(t=>{let e=new FileReader;e.onload=function(t){let e=t.target.result;processFile(e)},e.readAsText(t)}))});let globalArticles=[];async function processFile(t){let e=t.split("\n"),l=[],r={};for(let s of e)s.startsWith("ABSTRACT:")?(r.abstract&&(l.push(r),r={}),r.abstract=s.substring(9).trim()):s.startsWith("AUTHOR KEYWORDS:")?r.authorKeyword=s.substring(16).trim():s.startsWith("INDEX KEYWORDS:")&&(r.indexKeyword=s.substring(15).trim());r.abstract&&l.push(r),globalArticles=[...globalArticles,...l],displayResults(l,!0)}function displayResults(t,e=!1){let l=document.getElementById("resultsTable"),r=document.getElementById("tableBody");e||(r.innerHTML="");let s=e?r.rows.length+1:1;t.forEach(t=>{let e=`<tr>
            <td>${s++}</td>
            <td>${t.abstract}</td>
            <td>${t.authorKeyword||""}</td>
            <td>${t.indexKeyword||""}</td>
        </tr>`;r.innerHTML+=e}),l.style.display="table"}function clearResults(){let t=document.getElementById("tableBody");t.innerHTML="",globalArticles=[]}function downloadCSV(t,e){let l,r;l=new Blob([t],{type:"text/csv"}),(r=document.createElement("a")).download=e,r.href=window.URL.createObjectURL(l),r.style.display="none",document.body.appendChild(r),r.click()}function exportTableToCSV(t){let e=["Index,Abstract,Author Keyword,Index Keyword"];globalArticles.forEach((t,l)=>{let r=[l+1,`"${t.abstract.replace(/"/g,'""')}"`,`"${(t.authorKeyword||"").replace(/"/g,'""')}"`,`"${(t.indexKeyword||"").replace(/"/g,'""')}"`];e.push(r.join(","))});let l=e.join("\n");downloadCSV(l,t)}